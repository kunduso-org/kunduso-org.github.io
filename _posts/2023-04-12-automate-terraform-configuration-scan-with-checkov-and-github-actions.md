---
title: "Automate Terraform configuration scan with Checkov and GitHub Actions"
date: 2023-04-12 23:58:32 +0000
categories: []
tags: []
---

<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Terraform enables developers to create <strong>cloud resources via a few lines of code.</strong> Hence, these developers must write code that is easy to understand and <strong>follows security best practices.</strong> Moreover, following best practices becomes a habit if there is a system to keep that in check. <strong>Checkov</strong> is a proven static analysis tool that checks for <strong>standard best practices</strong> in your Terraform code.</span></span></span>
<!--more--><span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">In this note, I will show you how to ensure that your Terraform code stored in a <span style="text-decoration: underline">public GitHub repository</span> is continuously scanned against the Checkov rules using <strong>GitHub Actions</strong>.</span></span></span>

<em><span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Note: As a reader, I assume you are familiar with Terraform, Checkov, and GitHub Actions.</span></span></span></em>

<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Code scanning is <span style="text-decoration: underline">auto-enabled</span> once you add the Checkov scanning YAML file to your repository, provided your repository is <strong>open source (public repository)</strong>. Before adding the code scanning YAML file, code scanning alerts were not enabled in my repository. This setting is accessible via the Security menu -&gt; Vulnerability alerts -&gt; Code scanning.</span></span></span>
<img class="alignnone size-full wp-image-2491" src="https://skundunotes.com/wp-content/uploads/2023/04/73-image-2.png" alt="73-image-2" width="630" height="75" />
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">For <span style="text-decoration: underline">private repositories</span>, chances are that the <span style="text-decoration: underline">code scanning alerts are disabled</span>. You can find out how to enable that via <a href="https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/about-code-scanning" target="_blank" rel="noopener">GitHub-docs-code-scanning</a>.</span></span></span>
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">I have a public repository and did not have to enable this setting manually. After adding the <code>checkov</code> scan YAML file in the <code>.github\workflows</code> folder and pushing the changes to the GitHub remote, the scanning process started <span style="text-decoration: underline">automatically</span> under GitHub Actions. And that is due to the trigger setting that I set to <code>on: push: branches ["*"]</code>.</span></span></span>

<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">You can control when the scan pipeline runs based on the <code>on: setting</code> in the YAML file. I enabled scanning for all the branches so that as part of development (when I am working on a separate branch,) the scan results are still available for me to review. The checkov scan pipeline will fail until all the static code analysis checks pass.</span></span></span>

<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Although you can navigate to the Checkov GitHub Action step in the GitHub Actions pipeline run to evaluate the result and find out which Checkov rule is failing in which file, a <span style="text-decoration: underline">better user interface</span> is available under the Security menu -&gt; Vulnerability alerts -&gt; Code scanning. The report shows the violations for the <span style="text-decoration: underline">default branch</span>. If you are yet to merge your changes to the main branch or are working on a separate branch, select your specific branch (dropdown) and review the violations.</span></span></span>
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">The below image shows the violations reported in my <a href="https://github.com/kunduso/add-aws-secretsmanager-terraform" target="_blank" rel="noopener">GitHub repository: <code>add-aws-secretsmanager-terraform</code></a>, where the branch is <code>add-scaffolding</code>.</span></span></span>
<img class="alignnone size-full wp-image-2492" src="https://skundunotes.com/wp-content/uploads/2023/04/73-image-3.png" alt="73-image-3" width="939" height="312" />
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Once I start working on these violations and fixing my code, the open scan error count will reduce, and the closed count will increase. Ideally, we'd want code with no scanning violations.</span></span></span>

<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">I found the <span style="text-decoration: underline">Checkov GitHub Actions YAML pipeline neat and easy to work with</span>. If you want a static analysis tool to scan your Terraform code using GitHub Actions, <span style="text-decoration: underline">please try the Checkov YAML file</span>. You can check my repository for the <a href="https://github.com/kunduso/add-aws-secretsmanager-terraform/blob/main/.github/workflows/code-scan.yml" target="_blank" rel="noopener">pipeline code</a>, and GitHub Actions scan runs. You won't have access to the repository security tab because you need permission to access the repository for that.</span></span></span>

<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">I hope you found this note helpful. Please let me know if you have any questions, and I will answer them.</span></span></span>
