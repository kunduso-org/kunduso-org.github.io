---
title: "Automate Azure Boards iteration using PowerShell and Azure Pipelines"
date: 2022-12-29 12:52:05 +0000
categories: []
tags: []
---

<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">I start planning for the following year in the last two weeks of December. I use Azure DevOps to track my work  -break down goals into features, and features into user stories, which I map into sprints. Creating iterations and adding them to projects is something that anyone can automate.</span></span></span>
<!--more-->
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Last year I used the PowerShell script stored at my <strong>GitHub repo: <a href="https://github.com/kunduso/add-iterations-to-azure-devops-project" target="_blank" rel="noopener">add-iterations-to-azure-devops-project</a></strong>. I ran the PowerShell script from my local laptop, and the thought of automating that did not cross my mind because I thought I had to do it only once a year.</span></span></span>

<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Since then, I have changed my laptop and no longer have the <strong>Azure CLI and Azure DevOps modules installed</strong>. I am also working on two Azure DevOps projects requiring separate iterations and sprints. Moreover, variables had hardcoded values based on my requirements in the previous version of the PowerShell script. And so this year, <span style="text-decoration: underline">I not only converted the hard-coded variables to command-line arguments but also created an azure pipelines YAML file to automate the process.</span></span></span></span>

<em><span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Note: The PowerShell script continues to support execution from a local laptop. If that is the case, please refer to this detailed note  -<a href="https://skundunotes.com/2021/12/26/create-azure-devops-iterations-using-powershell/" target="_blank" rel="noopener">create-azure-devops-iterations-using-powershell</a>.</span></span></span></em>

<strong><span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">The process of creating Azure DevOps iterations using pipelines consists of 5 steps.</span></span></span></strong>
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">If you want the code repository handy as you walk through the steps, here's the link to my GitHub repo: <a href="https://github.com/kunduso/add-iterations-to-azure-devops-project" target="_blank" rel="noopener">add-iterations-to-azure-devops-project</a>.</span></span></span>

<strong><span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Step 1: Create a PAT</span></span></span></strong>
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">You can create an access token by following the steps mentioned in  -<a href="https://learn.microsoft.com/en-us/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate?view=azure-devops&amp;tabs=Windows#create-a-pat" target="_blank" rel="noopener">create a PAT</a>.</span></span></span>

<strong><span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Step 2: Create a variable group</span></span></span></strong>
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">I stored all the variables required by the pipeline YAML in a variable group. If you are new, you can follow my note <a href="https://skundunotes.com/2022/03/30/manage-secure-variables-with-azure-devops-library-and-azure-pipelines/" target="_blank" rel="noopener">azure-devops-library</a> to learn how to create variable groups in Azure DevOps.</span></span></span>
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">The PowerShell script requires eight variables, and I stored all of them in the variable group: <code>add-iterations-to-azure-devops-project</code>.</span></span></span>
<img class="alignnone  wp-image-2165" src="https://skundunotes.com/wp-content/uploads/2022/12/70-image-2.png" alt="70-image-2" width="661" height="358" />
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">If you desire to change any variable name here, including the variable group name, you must change that in the code, too  -the PowerShell script and the azure-pipelines YAML file. I have secured the Organization and PAT value, which is why it is hidden.</span></span></span>

<strong><span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Step 3: Create a pipeline</span></span></span></strong>
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">If you are new to using pipelines in Azure DevOps, you can follow my note at <a href="https://skundunotes.com/2020/05/15/getting-started-with-azure-devops-create-a-build-pipeline-part-1-yaml-pipeline/" target="_blank" rel="noopener">create-a-yaml-build-pipeline</a>. I used the <code>azure-pipelines.yml</code> that I stored in my GitHub repository: <code>add-iterations-to-azure-devops-project</code>. The rest of the process of creating the pipeline is quite intuitive.</span></span></span>

<strong><span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Step 4: Run the pipeline</span></span></span></strong>
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">The last step is to trigger the pipeline. When I ran the script for the first time, I had to provide permission for the pipeline to access the variable group referenced in the pipeline.</span></span></span>
<img class="alignnone size-full wp-image-2166" src="https://skundunotes.com/wp-content/uploads/2022/12/70-image-3.png" alt="70-image-3" width="1444" height="538" />
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">I did not have to provide permission for subsequent runs. You can review the latest build run log at <a href="https://littlecoding.visualstudio.com/Open-Project/_build?definitionId=36&amp;_a=summary" target="_blank" rel="noopener">kunduso.add-iterations-to-azure-devops-project</a>.</span></span></span>
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">I am copying a section of the log file below where you can see the output generated from the PowerShell script.</span></span></span>
<img class="alignnone  wp-image-2167" src="https://skundunotes.com/wp-content/uploads/2022/12/70-image-4.png" alt="70-image-4" width="608" height="381" />
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">After the build succeeded, I verified my Azure DevOps team project and found the iterations and sprints correctly created.</span></span></span>
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000"><strong>Verify:</strong> I clicked on the gear icon with <strong>"Project Settings"</strong> at the bottom left corner of my Azure DevOps team portal. Under settings -&gt; Boards -&gt; Team configuration -&gt; Iterations, I could see that the pipeline ran correctly and created the iterations. The below image is a section of the list.</span></span></span>
<img class="alignnone size-full wp-image-2168" src="https://skundunotes.com/wp-content/uploads/2022/12/70-image-5.png" alt="70-image-5" width="751" height="229" />
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">And under Project Settings -&gt; Boards -&gt; Project configuration -&gt; Iterations, I could see the Iterations were created.</span></span></span>
<img class="alignnone  wp-image-2169" src="https://skundunotes.com/wp-content/uploads/2022/12/70-image-6.png" alt="70-image-6" width="751" height="355" />
<strong><span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Step 5: Revoke the PAT</span></span></span></strong>
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Now that the pipeline had created the iterations, there was no point in keeping the PAT alive, and hence I <a href="https://learn.microsoft.com/en-us/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate?view=azure-devops&amp;tabs=Windows#revoke-a-pat" target="_blank" rel="noopener">revoked the PAT</a>. In the future, when I require this automation, I will generate a new PAT and store the value securely in the Library. And once used, I will revoke the PAT again.</span></span></span>

<strong><span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">What are the benefits of this automation?</span></span></span></strong>
<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">The automation process is independent of what is installed on my laptop; I did not have to install Azure CLI or keep up with the latest version. I only had to ensure the <code>vmImage</code> I am referring to in the pipelines YAML has the latest tools installed, which is usually the case. The second benefit is that with a few variable updates, I could run the script for a different Azure DevOps project.</span></span></span>

<span style="font-size: 18px"><span style="font-family: calibri"><span style="color: #000000">Which option you select  -running the PowerShell script locally or using the pipelines YAML depends on your specific use case. If you want to automate using Azure DevOps, this note should be helpful to you. Let me know if you have any suggestions or questions.</span></span></span>
