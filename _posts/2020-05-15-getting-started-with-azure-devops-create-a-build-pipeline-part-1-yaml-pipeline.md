---
title: "Getting started with Azure Devops -create a build pipeline -Part 1 (YAML pipeline)"
date: 2020-05-15 21:00:46 +0000
categories: []
tags: []
---

<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">This is <strong>part 5 of a multipart series on getting started with Azure DevOps</strong>. Please refer to the below links to access other notes in this series.</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><a href="https://skundunotes.com/2019/11/07/getting-started-with-azure-devops/" target="_blank" rel="noopener">Part 1: Getting started with Azure DevOps</a></span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><a href="http://skundunotes.com/2019/12/24/getting-started-with-azure-devops-work-items/" target="_blank" rel="noopener">Part 2: Getting started with Azure DevOps -work items</a></span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><a href="http://skundunotes.com/2020/03/17/getting-started-with-azure-devops-add-a-repo/" target="_blank" rel="noopener">Part 3: Getting started with Azure DevOps -add a repo</a></span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><a href="http://skundunotes.com/2020/02/19/getting-started-with-azure-devops-create-a-build-agent/" target="_blank" rel="noopener">Part 4: Getting started with Azure DevOps -create a build agent</a></span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">Part 5: Getting started with Azure DevOps -create a build pipeline -Part 1 (YAML pipeline) (this note)</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><a href="http://skundunotes.com/2020/05/15/getting-started-with-azure-devops-create-a-build-pipeline-part-2-classic-editor/" target="_blank" rel="noopener">Part 6: Getting started with Azure DevOps -create a build pipeline -Part 2 (Classic Editor)</a></span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><a href="http://skundunotes.com/2019/12/27/azure-devops-deployment-groups/" target="_blank" rel="noopener">Part 7: Getting started with Azure DevOps -create a deployment group</a></span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><a href="http://skundunotes.com/2020/05/22/getting-started-with-azure-devops-create-a-release-definition/" target="_blank" rel="noopener">Part 8: Getting started with Azure DevOps -create a release definition</a></span></span></span>

<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">Typically, a project starts with an idea or a concept of a product in mind. The concept is brainstormed, and features of the product are identified. These product features can be (loosely) translated to work items in development parlance. These features are then further broken down into user stories which further can be broken down into task and test cases. <em>Note: you could also start at epic then go to feature, then user stories... whatever suits the requirement and the project team.</em></span></span></span>
<!--more--><span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">We then create code against these user stories; write code to support the user stories. I am narrating at a fairly high level here but that is partly the essence of how we transform ideas into code. Over time we develop a code base with history -history of how the code went through a transition as more and more features were added. This codebase is (generally) tied to a build pipeline definition. A build pipeline definition (typically) compiles code and prepares a deployment package. This deployment package is then consumed by a release definition (more on that later).</span></span></span>

<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">I followed the below steps to create a build pipeline definition:
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">-I coded a windows service project using top-shelf and checked that into my Azure </span></span></span>DevOps project repo (git add -&gt; git commit -&gt; git push). Before I pushed code to Azure Repos I made sure that the project compiled and built fine</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">-on Azure DevOps portal access Pipelines (<em>ci/cd pipeline is the heart of any devops transformation</em>) and click on Create Pipeline<img class="alignnone size-full wp-image-509" src="https://skundunotes.com/wp-content/uploads/2020/05/ad-gs-pipeline-image1.png" alt="AD-GS-Pipeline-Image1" width="525" height="336"></span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">There are two ways to create a build pipeline definition from the repository</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">-yaml based</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">-<a href="http://skundunotes.com/2020/05/15/getting-started-with-azure-devops-create-a-build-pipeline-part-2-classic-editor">classic editor (non yaml)</a></span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">Microsoft wants users to move to yaml based rather than stick to the old classic editor. Why? Here is an image of how you are greeted when you attempt to create a pipeline</span></span></span>
<img class="alignnone size-full wp-image-510" src="https://skundunotes.com/wp-content/uploads/2020/05/ad-gs-pipeline-image2.png" alt="AD-GS-Pipeline-Image2" width="575" height="498">
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">Do you see the difference? YAML based gets 95% of the screen while the classic editor is just one line at the bottom. Later on, I'll list the benefits and drawbacks of both and which one makes sense and where. For now, we follow YAML based and stick to the flow.</span></span></span>

<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><strong>Step 1:</strong> Select your code</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">Here you select your current project.</span></span></span>
<img class="alignnone size-full wp-image-511" src="https://skundunotes.com/wp-content/uploads/2020/05/ad-gs-pipeline-image3.png" alt="AD-GS-Pipeline-Image3" width="642" height="248">
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><strong>Step 2:</strong> …and then configure which build framework we prefer. There are a lot of options here as can be seen from a small snippet that I grabbed.</span></span></span>
<img class="alignnone size-full wp-image-512" src="https://skundunotes.com/wp-content/uploads/2020/05/ad-gs-pipeline-image4.png" alt="AD-GS-Pipeline-Image4" width="630" height="653">
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">I selected the “Starter pipeline” which added (unsaved yet) an <strong><em>azure-pipelines.yml</em></strong> file to the root of the project directory in the current project repo.</span></span></span>
<img class="alignnone size-full wp-image-513" src="https://skundunotes.com/wp-content/uploads/2020/05/ad-gs-pipeline-image5.png" alt="AD-GS-Pipeline-Image5" width="719" height="496">
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><strong>Step 3 (a):</strong> This is a standard empty pipeline that needed more work but at least the framework was in place. And depending on what steps are needed to build a project, they can be added or removed from this file.</span></span></span>
<em><span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">I went through this link to understand YAML build-pipelines: <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/yaml-schema?view=azure-devops&amp;tabs=schema%2Cparameter-schema" target="_blank" rel="noopener">YAML Schema</a></span></span></span></em>

<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><strong>Step 3 (b):</strong> To make practitioners use/migrate to YAML, there is a cool feature that comes in handy to ensure that normal coding mistakes are avoided -<strong>task assistant</strong>. I edited azure-pipelines.yml file and typed-in the build step that I wanted to insert and <em>IntelliSense</em> came up with a few identical build steps that might be relevant. </span></span></span>
<img class="alignnone size-full wp-image-528" src="https://skundunotes.com/wp-content/uploads/2020/05/ad-gs-pipeline-image18.png" alt="AD-GS-Pipeline-Image18" width="977" height="599">
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">I then select the build step that was relevant and clicked on <strong><em>add</em></strong>. That build step appeared in the azure-pipelines.yml file. This feature has been quite useful in getting myself familiarized with using YAML in azure pipelines.</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><strong>Note:</strong> The task assistant is not accessible if we open azure-pipelines.yaml file from Azure Repos. <em>Instead, the way to load task assistant is to access via the build pipeline: Pipeline-&gt; Click on the particular pipeline we want to edit -&gt; click on Edit (top right corner).</em></span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">This loaded up the azure-pipelines.yml file and on the right-hand side, there is a Tasks assistant pane that looked something like this.</span></span></span>
<img class="alignnone size-full wp-image-524" src="https://skundunotes.com/wp-content/uploads/2020/05/ad-gs-pipeline-image15.png" alt="AD-GS-Pipeline-Image15" width="321" height="495">
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">Here is an example of a task: AWS CLI.</span></span></span>
<img class="alignnone size-full wp-image-525" src="https://skundunotes.com/wp-content/uploads/2020/05/ad-gs-pipeline-image16.png" alt="AD-GS-Pipeline-Image16" width="962" height="561">
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">In this case, we fill in the values and click on <em>Add</em> which adds the step to our azure-pipelines.yml file. Here’s an example:</span></span></span>
<img class="alignnone size-full wp-image-526" src="https://skundunotes.com/wp-content/uploads/2020/05/ad-gs-pipeline-image17.png" alt="AD-GS-Pipeline-Image17" width="606" height="450">
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">Line 66 to 68 were added by Task assistant.</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><strong>Step 4:</strong> Once we had build steps finalized, I <em>save</em>d (on the top right corner) to commit this file to our repo root.</span></span></span>
<img class="alignnone size-full wp-image-514" src="https://skundunotes.com/wp-content/uploads/2020/05/ad-gs-pipeline-image6.png" alt="AD-GS-Pipeline-Image6" width="437" height="492">
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">From this step it is easy to see the benefit of a YAML based approach - our repo contains the code and also the build pipeline file required to build the code. This implies that anyone can take this repo and not have to worry about what are the build steps to generate executables or create artifacts to deploy.</span></span></span>

<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;"><strong>Step 5:</strong> After saving, we run our pipeline.</span></span></span>
<img class="alignnone size-full wp-image-515" src="https://skundunotes.com/wp-content/uploads/2020/05/ad-gs-pipeline-image7.png" alt="AD-GS-Pipeline-Image7" width="746" height="272">
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">The above image has a couple of descriptions of pipeline runs. Ideally, a pipeline would have the following steps:</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">-get code</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">-get dependencies</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">-build code</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">-package code/create artifacts</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">That is about the YAML based approach.</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">The other approach was using the classic editor. I have used the editor extensively at my work over the last few years because, well, the classic editor was released earlier than YAML.</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">I posted <a href="http://skundunotes.com/2020/05/15/getting-started-with-azure-devops-create-a-build-pipeline-part-2-classic-editor">part 2 of this note</a> on how to create a pipeline using the classic editor because there are some nuances to it and I wanted to keep the two pipeline approaches separately.</span></span></span>

<strong><span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">Notes:</span></span></span></strong>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">Moving forward I think YAML is way to go. The ability to version your pipeline along with your code is one of the biggest benefits that can be derived by this approach.</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">E.g., consider a project team that has three active branches -dev, test, and release where the <em>release</em> branch has the version of code that is already in production and <em>test</em> has the version that is going to production next while <em>dev</em> is not yet ready for production. In the classic editor option, we would require three build pipelines associated (same as YAML based) with these three branches and none of these pipeline definitions would have any association with each other. Although we can compare and see how a build pipeline has changed but there is no way to ensure that the changes are in sync with the code merge. If during a code merge there is a change required to the build pipeline, that step is independent of code merge and should be managed outside and is not visible from code merge perspective. That visibility is offered in the YAML based approach.</span></span></span>

<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">The other benefit I see is around productivity. Anyone can clone my repo and have a package ready in a short time because they’d also gain access to the build pipeline YAML file. This is important because you want people to use your repo and benefit from it and I think providing them with the ability to get started quickly is a value add, along with access to your repo for sure.</span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">Next, <a href="http://skundunotes.com/2020/05/15/getting-started-with-azure-devops-create-a-build-pipeline-part-2-classic-editor/">Part 6: Getting started with Azure DevOps -create a build pipeline -Part 2 (Classic Editor)</a></span></span></span>
<span style="font-size:18px;"><span style="font-family:calibri;"><span style="color:#000000;">PS: Anyone familiar with the task-group would understand that the YAML build pipeline does not support task groups (as of when this article was written). Both these approaches more or less address similar issues and it makes sense to not merge them.</span></span></span>
